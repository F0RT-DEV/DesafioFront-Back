<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClimaTrack - Painel Climático</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-cloud-sun"></i> ClimaTrack</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" id="dashboard-link">
                        <i class="fas fa-home"></i> Painel
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" id="locations-link">
                        <i class="fas fa-map-marker-alt"></i> Locais
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" id="records-link">
                        <i class="fas fa-temperature-low"></i> Registros
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section (mantido igual) -->
            
            <!-- Locations Section -->
            <section id="locations-section" class="locations-container">
                <div class="header">
                    <h1>Locais Cadastrados</h1>
                    <button class="btn btn-success" id="add-location-btn">
                        <i class="fas fa-plus"></i> Adicionar Local
                    </button>
                </div>

                <div class="search-filter">
                    <input type="text" id="location-search" class="search-input" placeholder="Buscar local...">
                    <select class="state-filter" id="state-filter">
                        <option value="all">Todos os estados</option>
                        <option value="SP">São Paulo</option>
                        <option value="RJ">Rio de Janeiro</option>
                        <option value="MG">Minas Gerais</option>
                        <!-- Outros estados podem ser adicionados aqui -->
                    </select>
                </div>

                <div class="locations-list">
                    <div class="table-responsive">
                        <table class="locations-table">
                            <thead>
                                <tr>
                                    <th>Nome do Local</th>
                                    <th>Estado</th>
                                    <th>Última Atualização</th>
                                    <th>Temperatura Atual</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="locations-table-body">
                                <!-- Os dados serão inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination-controls">
                        <button class="btn btn-outline" id="prev-page"><i class="fas fa-chevron-left"></i></button>
                        <span id="page-info">Página 1 de 10</span>
                        <button class="btn btn-outline" id="next-page"><i class="fas fa-chevron-right"></i></button>
                        <select class="page-size-select" id="page-size">
                            <option value="10">10 itens</option>
                            <option value="25">25 itens</option>
                            <option value="50">50 itens</option>
                            <option value="100">100 itens</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Temperature Records Section -->
            <section id="records-section" class="records-container">
                <div class="header">
                    <h1>Registros de Temperatura</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="export-records">
                            <i class="fas fa-file-export"></i> Exportar
                        </button>
                    </div>
                </div>

                <div class="records-filters">
                    <div class="filter-group">
                        <label for="record-location-filter">Local:</label>
                        <select id="record-location-filter" class="filter-select">
                            <option value="all">Todos os locais</option>
                            <!-- Opções serão preenchidas via JavaScript -->
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="date-range-filter">Período:</label>
                        <select id="date-range-filter" class="filter-select">
                            <option value="today">Hoje</option>
                            <option value="week">Esta semana</option>
                            <option value="month">Este mês</option>
                            <option value="custom">Personalizado</option>
                        </select>
                    </div>
                    <div class="filter-group custom-date-range" style="display: none;">
                        <input type="date" id="start-date-filter" class="date-input">
                        <span>até</span>
                        <input type="date" id="end-date-filter" class="date-input">
                    </div>
                </div>

                <div class="records-list">
                    <div class="table-responsive">
                        <table class="records-table">
                            <thead>
                                <tr>
                                    <th>Local</th>
                                    <th>Data/Hora</th>
                                    <th>Temperatura (°C)</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="records-table-body">
                                <!-- Os dados serão inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination-controls">
                        <button class="btn btn-outline" id="records-prev-page"><i class="fas fa-chevron-left"></i></button>
                        <span id="records-page-info">Página 1 de 20</span>
                        <button class="btn btn-outline" id="records-next-page"><i class="fas fa-chevron-right"></i></button>
                        <select class="page-size-select" id="records-page-size">
                            <option value="50">50 itens</option>
                            <option value="100">100 itens</option>
                            <option value="200">200 itens</option>
                        </select>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Location Modal (mantido igual) -->

    <!-- Edit Record Modal -->
    <div class="modal" id="edit-record-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Editar Registro</h3>
                <button class="close-btn" id="close-edit-modal">&times;</button>
            </div>
            <form id="edit-record-form">
                <input type="hidden" id="edit-record-id">
                <div class="form-group">
                    <label for="edit-location-name" class="form-label">Local</label>
                    <input type="text" id="edit-location-name" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label for="edit-record-date" class="form-label">Data</label>
                    <input type="date" id="edit-record-date" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-record-time" class="form-label">Horário</label>
                    <input type="time" id="edit-record-time" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-record-temperature" class="form-label">Temperatura (°C)</label>
                    <input type="number" id="edit-record-temperature" class="form-control" step="0.1" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Salvar Alterações
                    </button>
                    <button type="button" class="btn btn-danger" id="delete-record-btn">
                        <i class="fas fa-trash"></i> Excluir Registro
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variáveis globais para controle de paginação
        let currentPage = 1;
        let currentRecordsPage = 1;
        let pageSize = 10;
        let recordsPageSize = 50;
        let totalLocations = 1000; // Simulação - deve vir da API
        let totalRecords = 10000; // Simulação - deve vir da API

        // Dados de exemplo (simulando o banco de dados)
        const sampleLocations = [
            { id: 1, name: "São Paulo", state: "SP", lastUpdate: "2025-04-25 10:30", temperature: 24 },
            { id: 2, name: "Rio de Janeiro", state: "RJ", lastUpdate: "2025-04-25 09:45", temperature: 28 },
            { id: 3, name: "Belo Horizonte", state: "MG", lastUpdate: "2025-04-25 08:15", temperature: 22 },
            { id: 4, name: "Curitiba", state: "PR", lastUpdate: "2025-04-24 14:20", temperature: 18 },
            { id: 5, name: "Porto Alegre", state: "RS", lastUpdate: "2025-04-24 16:10", temperature: 20 },
            // Adicione mais locais conforme necessário para teste
        ];

        const sampleRecords = [
            { id: 1, locationId: 1, locationName: "São Paulo", date: "2025-04-25", time: "10:30", temperature: 24 },
            { id: 2, locationId: 1, locationName: "São Paulo", date: "2025-04-25", time: "09:30", temperature: 23 },
            { id: 3, locationId: 1, locationName: "São Paulo", date: "2025-04-25", time: "08:30", temperature: 21 },
            { id: 4, locationId: 2, locationName: "Rio de Janeiro", date: "2025-04-25", time: "09:45", temperature: 28 },
            { id: 5, locationId: 3, locationName: "Belo Horizonte", date: "2025-04-25", time: "08:15", temperature: 22 },
            // Adicione mais registros conforme necessário para teste
        ];

        // Função para carregar locais com paginação
        function loadLocations(page = 1) {
            currentPage = page;
            const startIdx = (page - 1) * pageSize;
            const endIdx = startIdx + pageSize;
            
            // Simulação - na prática, isso viria de uma API
            const displayedLocations = sampleLocations.slice(startIdx, endIdx);
            
            const tableBody = document.getElementById('locations-table-body');
            tableBody.innerHTML = '';
            
            displayedLocations.forEach(location => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${location.name}</td>
                    <td>${location.state}</td>
                    <td>${formatDateTime(location.lastUpdate)}</td>
                    <td>${location.temperature}°C</td>
                    <td class="actions">
                        <button class="btn-icon btn-refresh" data-id="${location.id}" title="Atualizar">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="btn-icon btn-view-records" data-id="${location.id}" title="Ver registros">
                            <i class="fas fa-list"></i>
                        </button>
                        <button class="btn-icon btn-delete" data-id="${location.id}" title="Excluir">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Atualizar controles de paginação
            updatePaginationControls();
        }

        // Função para carregar registros com paginação
        function loadRecords(page = 1) {
            currentRecordsPage = page;
            const startIdx = (page - 1) * recordsPageSize;
            const endIdx = startIdx + recordsPageSize;
            
            // Simulação - na prática, isso viria de uma API com filtros
            const displayedRecords = sampleRecords.slice(startIdx, endIdx);
            
            const tableBody = document.getElementById('records-table-body');
            tableBody.innerHTML = '';
            
            displayedRecords.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.locationName}</td>
                    <td>${formatDate(record.date)} ${record.time}</td>
                    <td>${record.temperature}°C</td>
                    <td class="actions">
                        <button class="btn-icon btn-edit" data-id="${record.id}" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-icon btn-delete-record" data-id="${record.id}" title="Excluir">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Atualizar controles de paginação
            updateRecordsPaginationControls();
        }

        // Funções auxiliares
        function formatDateTime(dateTimeStr) {
            const [date, time] = dateTimeStr.split(' ');
            return `${formatDate(date)} ${time}`;
        }

        function formatDate(dateStr) {
            const [year, month, day] = dateStr.split('-');
            return `${day}/${month}/${year}`;
        }

        function updatePaginationControls() {
            const totalPages = Math.ceil(totalLocations / pageSize);
            document.getElementById('page-info').textContent = `Página ${currentPage} de ${totalPages}`;
            
            document.getElementById('prev-page').disabled = currentPage === 1;
            document.getElementById('next-page').disabled = currentPage === totalPages;
        }

        function updateRecordsPaginationControls() {
            const totalPages = Math.ceil(totalRecords / recordsPageSize);
            document.getElementById('records-page-info').textContent = `Página ${currentRecordsPage} de ${totalPages}`;
            
            document.getElementById('records-prev-page').disabled = currentRecordsPage === 1;
            document.getElementById('records-next-page').disabled = currentRecordsPage === totalPages;
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Navegação entre seções
            document.getElementById('dashboard-link').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('dashboard-section').style.display = 'block';
                document.getElementById('locations-section').style.display = 'none';
                document.getElementById('records-section').style.display = 'none';
                setActiveNav(this);
            });

            document.getElementById('locations-link').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('dashboard-section').style.display = 'none';
                document.getElementById('locations-section').style.display = 'block';
                document.getElementById('records-section').style.display = 'none';
                setActiveNav(this);
                loadLocations();
            });

            document.getElementById('records-link').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('dashboard-section').style.display = 'none';
                document.getElementById('locations-section').style.display = 'none';
                document.getElementById('records-section').style.display = 'block';
                setActiveNav(this);
                loadRecords();
            });

            // Controles de paginação
            document.getElementById('prev-page').addEventListener('click', function() {
                if (currentPage > 1) {
                    loadLocations(currentPage - 1);
                }
            });

            document.getElementById('next-page').addEventListener('click', function() {
                const totalPages = Math.ceil(totalLocations / pageSize);
                if (currentPage < totalPages) {
                    loadLocations(currentPage + 1);
                }
            });

            document.getElementById('page-size').addEventListener('change', function() {
                pageSize = parseInt(this.value);
                loadLocations(1);
            });

            document.getElementById('records-prev-page').addEventListener('click', function() {
                if (currentRecordsPage > 1) {
                    loadRecords(currentRecordsPage - 1);
                }
            });

            document.getElementById('records-next-page').addEventListener('click', function() {
                const totalPages = Math.ceil(totalRecords / recordsPageSize);
                if (currentRecordsPage < totalPages) {
                    loadRecords(currentRecordsPage + 1);
                }
            });

            document.getElementById('records-page-size').addEventListener('change', function() {
                recordsPageSize = parseInt(this.value);
                loadRecords(1);
            });

            // Filtro de período personalizado
            document.getElementById('date-range-filter').addEventListener('change', function() {
                const customDateRange = document.querySelector('.custom-date-range');
                customDateRange.style.display = this.value === 'custom' ? 'flex' : 'none';
            });

            // Inicialização
            setActiveNav(document.getElementById('dashboard-link'));
            loadLocations();
            loadRecords();
        });

        function setActiveNav(activeElement) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            activeElement.classList.add('active');
        }

        // ... (mantenha o resto do JavaScript anterior) ...
    </script>
</body>
</html>